<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WebGIS IPEA</title>

  <!-- Evita 404 de favicon no console -->
  <link rel="icon" href="data:," />

  <!-- Leaflet LOCAL (sem CDN) -->
  <link rel="stylesheet" href="vendor/leaflet/leaflet.css" />

  <!-- Seu CSS -->
  <link rel="stylesheet" href="css/style.css?v=20260212" />
</head>

<body>
  <!-- MAPA -->
  <div id="map" role="application" aria-label="Mapa interativo"></div>

  <!-- Botão + Painel lateral de INFO -->
  <button id="btnInfo" class="btn-info" type="button" aria-controls="infoPanel" aria-expanded="false">
    Info
  </button>

  <div id="infoPanel" class="info-panel hidden" aria-hidden="true">
    <div class="info-header">
      <div class="info-title">Informações do Mapa</div>
      <button id="btnInfoClose" class="info-close" type="button" aria-label="Fechar painel de informações">✕</button>
    </div>
    <div id="infoBody" class="info-body"></div>
  </div>

  <!-- Painel de filtros -->
  <div id="filters" class="filters" role="region" aria-label="Filtros do mapa">
    <div class="filters-title">Filtros</div>

    <label for="regSelect">Região</label>
    <select id="regSelect" aria-label="Selecionar região">
      <option value="">(todas)</option>
      <option value="Norte">Norte</option>
      <option value="Nordeste">Nordeste</option>
      <option value="Centro-Oeste">Centro-Oeste</option>
      <option value="Sudeste">Sudeste</option>
      <option value="Sul">Sul</option>
    </select>

    <label for="ufSelect">UF</label>
    <select id="ufSelect" aria-label="Selecionar UF">
      <option value="">(todas)</option>
      <option value="AC">AC</option><option value="AL">AL</option><option value="AM">AM</option><option value="AP">AP</option>
      <option value="BA">BA</option><option value="CE">CE</option><option value="DF">DF</option><option value="ES">ES</option>
      <option value="GO">GO</option><option value="MA">MA</option><option value="MG">MG</option><option value="MS">MS</option>
      <option value="MT">MT</option><option value="PA">PA</option><option value="PB">PB</option><option value="PE">PE</option>
      <option value="PI">PI</option><option value="PR">PR</option><option value="RJ">RJ</option><option value="RN">RN</option>
      <option value="RO">RO</option><option value="RR">RR</option><option value="RS">RS</option><option value="SC">SC</option>
      <option value="SE">SE</option><option value="SP">SP</option><option value="TO">TO</option>
    </select>

    <label for="regicSelect">REGIC 2018</label>
    <select id="regicSelect" aria-label="Selecionar hierarquia REGIC 2018">
      <option value="">(todas)</option>
      <option value="Centro Local">Centro Local</option>
      <option value="Centro Sub-Regional A">Centro Sub-Regional A</option>
      <option value="Centro Sub-Regional B">Centro Sub-Regional B</option>
      <option value="Centro de Zona A">Centro de Zona A</option>
      <option value="Centro de Zona B">Centro de Zona B</option>
      <option value="Capital Regional A">Capital Regional A</option>
      <option value="Capital Regional B">Capital Regional B</option>
      <option value="Capital Regional C">Capital Regional C</option>
      <option value="Metrópole">Metrópole</option>
      <option value="Metrópole Nacional">Metrópole Nacional</option>
      <option value="Grande Metrópole Nacional">Grande Metrópole Nacional</option>
    </select>

    <button id="btnClear" type="button" aria-label="Limpar filtros">Limpar filtro</button>
  </div>

  <!-- Legenda -->
  <div id="legend" class="legend" role="region" aria-label="Legenda do mapa">
    <div class="legend-title">Legenda</div>
    <div id="legend-items"></div>
  </div>

  <!-- JS (ordem correta) -->
  <script src="vendor/leaflet/leaflet.js"></script>

  <!-- TopoJSON (apenas se você realmente estiver usando TopoJSON em algum arquivo) -->
  <script src="vendor/topojson/topojson-client.min.js"></script>

  <!-- Seu map.js (sem defer, porque depende de Leaflet já carregado acima) -->
  <script src="js/map.js?v=20260212"></script>

  <!-- Acessibilidade: sincroniza aria do botão Info com o painel -->
  <script>
    (function syncInfoAria() {
      const btn = document.getElementById('btnInfo');
      const panel = document.getElementById('infoPanel');
      const close = document.getElementById('btnInfoClose');

      function setState(open) {
        btn.setAttribute('aria-expanded', open ? 'true' : 'false');
        panel.setAttribute('aria-hidden', open ? 'false' : 'true');
      }

      // Estado inicial
      setState(!panel.classList.contains('hidden'));

      btn?.addEventListener('click', () => {
        const open = !panel.classList.contains('hidden');
        setState(open);
      });

      close?.addEventListener('click', () => {
        setState(false);
      });
    })();
  </script>
</body>
</html>


